{"version":3,"sources":["../../lib/dukpt.lib.js"],"names":[],"mappings":"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","file":"dukpt.lib.js","sourcesContent":["'use strict';\n\nconst aesjs = require('aes-js');\nconst DataOperations = require('./data.lib');\n\nclass Dukpt {\n    constructor(bdk, ksn, keyMode) {\n        this.bdk = bdk;\n        this.ksn = ksn;\n\n        this._sessionKey = this._deriveDukptSessionKey(keyMode);\n    }\n\n    _deriveDukptSessionKey(keyMode) {\n        const dBDK = this.bdk;\n        const dKSN = this.ksn;\n\n        keyMode = keyMode || 'datakey';\n\n        if (DataOperations.fieldEmpty([dBDK, dKSN])) {\n            return new Error('a field is blank');\n        }\n        if (dBDK.replace(/\\s/g, '').length !== 32 ||\n            dKSN.replace(/\\s/g, '').length !== 20) {\n            return new Error('Key must be 16 bytes long and KSN must be 10 bytes');\n        }\n\n        const ipek = Dukpt._createIPEK(dBDK, dKSN); // Always start with IPEK\n\n        if (keyMode === 'datakey') { this._sessionKey = Dukpt._createDataKeyHex(ipek, dKSN); }\n\n        if (keyMode === 'pinkey') {\n            this._sessionKey = Dukpt._createPINKeyHex(ipek, dKSN);\n        }\n\n        if (keyMode === 'mackey') {\n            this._sessionKey = Dukpt._createMACKeyHex(ipek, dKSN);\n        }\n\n        return this._sessionKey;\n    }\n\n    static generateDukptSessionKey(ipek, ksn) {\n        if (DataOperations.fieldEmpty([ipek, ksn])) {\n            throw new Error('either IPEK or data params not provided');\n        }\n\n        return Dukpt._createDataKeyHex(ipek, ksn);\n    }\n\n    static _createDataKeyHex(ipek, ksn) {\n        const derivedPEK = Dukpt._deriveKeyHex(ipek, ksn);\n\n        const CBC = 1; // cipher block chaining enabled\n        const iv = '\\0\\0\\0\\0\\0\\0\\0\\0'; // initial vector\n        const variantMask = '0000000000FF00000000000000FF0000'; // data variant\n\n        let maskedPEK = DataOperations.XORdataHex(variantMask, derivedPEK); // apply mask\n\n        maskedPEK = DataOperations.hexstringToData(maskedPEK);\n\n        // We need to TDES-encrypt the masked key in two parts, using\n        // itself as the key. This is a so-called one-way function (OWF).\n        // The leftmost 8 bytes are encrypted, then\n        // the rightmost 8 bytes are encrypted separately. In each case,\n        // the key is the entire original 16-byte maskedPEK from the\n        // above step, expanded to 24 bytes per EDE3.\n\n        // left half:\n        const left = Dukpt._des(Dukpt._EDE3KeyExpand(maskedPEK),\n            maskedPEK.substring(0, 8),\n            true,\n            CBC,\n            iv,\n            null);\n\n        // right half:\n        const right = Dukpt._des(Dukpt._EDE3KeyExpand(maskedPEK),\n            maskedPEK.substring(8),\n            true,\n            CBC,\n            iv,\n            null);\n\n        let sessionKey = left + right;\n\n        sessionKey = DataOperations.dataToHexstring(sessionKey);\n        return sessionKey; // hex\n    }\n\n    static _createPINKeyHex(ipek, ksn) {\n        const derivedPEK = Dukpt._deriveKeyHex(ipek, ksn); // derive DUKPT basis key\n        const variantMask = '00000000000000FF00000000000000FF'; // PIN variant\n        return DataOperations.XORdataHex(variantMask, derivedPEK); // apply mask\n    }\n\n    static _createMACKeyHex(ipek, ksn) {\n        const derivedPEK = Dukpt._deriveKeyHex(ipek, ksn); // derive DUKPT basis key\n        const variantMask = '000000000000FF00000000000000FF00'; // MAC variant\n        return DataOperations.XORdataHex(variantMask, derivedPEK); // apply mask\n    }\n\n    static encryptTDES(key, data, encryptTrueFalse) {\n        const CBC = 1; // cipher block chaining enabled\n        const iv = '\\0\\0\\0\\0\\0\\0\\0\\0'; // initial vector\n\n        try {\n            // convert to binary\n            const binaryKey = DataOperations.hexstringToData(key);\n            let binaryData = DataOperations.hexstringToData(data);\n\n            // data should be a multiple of 8 bytes\n            while (binaryData.length % 8) {\n                binaryData += '\\0';\n            }\n\n            return Dukpt._des(binaryKey,\n                binaryData,\n                encryptTrueFalse,\n                CBC,\n                iv,\n                null);\n        } catch (e) {\n            throw e;\n        }\n    }\n\n    dukptEncrypt(dataToEncrypt, encryptOptions) {\n        let data = dataToEncrypt;\n        let encryptedOutput = null;\n\n        const _defaultOptions = {\n            encryptionMode: '3DES',\n            inputEncoding: 'ascii',\n            outputEncoding: 'hex'\n        };\n\n        const options = Object.assign({}, _defaultOptions, encryptOptions);\n\n        switch (options.inputEncoding.toLowerCase()) {\n        case 'ascii':\n            data = DataOperations.dataToHexstring(data);\n            break;\n        case 'hex':\n                // do nothing\n            break;\n        default:\n            throw new Error(`unsupported input encoding type for dukpt encrypt : '${options.inputEncoding}'`);\n        }\n\n        let key = this._sessionKey.replace(/\\s/g, ''); // remove spaces\n\n        if (!key || !data) {\n            throw new Error('either session key or data not provided');\n        }\n\n        data = data.replace(/\\s/g, '');\n\n        if (key.length === 32 && options.encryptionMode.toUpperCase() !== 'AES') {\n            key = Dukpt._EDE3KeyExpand(key);\n        }\n\n        switch (options.encryptionMode.toUpperCase()) {\n        case '3DES':\n            encryptedOutput = Dukpt.encryptTDES(key, data, true);\n            break;\n        case 'AES':\n            encryptedOutput = Dukpt.encryptAES(key, data);\n            break;\n        default:\n            throw new Error('unsupported dukpt encryption method');\n        }\n\n        switch (options.outputEncoding.toLowerCase()) {\n        case 'hex':\n            encryptedOutput = DataOperations.dataToHexstring(encryptedOutput);\n            break;\n        case 'ascii':\n                // do nothing\n            break;\n        default:\n            throw new Error(`unsupported output encoding type for dukpt decrypt : '${options.outputEncoding}'`);\n        }\n\n        return encryptedOutput;\n    }\n\n    dukptDecrypt(dataToDecrypt, decryptOptions) {\n        let encryptedData = dataToDecrypt;\n        let decryptedOutput = null;\n\n        const _defaultOptions = {\n            decryptionMode: '3DES',\n            trimOutput: false,\n            inputEncoding: 'hex',\n            outputEncoding: 'ascii'\n        };\n\n        const options = Object.assign({}, _defaultOptions, decryptOptions);\n\n        let key = this._sessionKey.replace(/\\s/g, ''); // remove spaces\n\n        if (!key || !encryptedData) {\n            throw new Error('either session key or data not provided');\n        }\n\n        encryptedData = encryptedData.replace(/\\s/g, '');\n\n        if (key.length === 32 && options.decryptionMode.toUpperCase() !== 'AES') {\n            key = Dukpt._EDE3KeyExpand(key);\n        }\n\n        switch (options.decryptionMode.toUpperCase()) {\n        case '3DES':\n            decryptedOutput = Dukpt.encryptTDES(key, encryptedData, false);\n            break;\n        case 'AES':\n            decryptedOutput = Dukpt.decryptAES(key, encryptedData);\n            break;\n        default:\n            throw new Error('unsupported dukpt decryption method');\n        }\n\n        if (options.trimOutput) {\n            decryptedOutput = DataOperations.removeNullCharsFromAscii(decryptedOutput);\n        }\n\n        switch (options.outputEncoding.toLowerCase()) {\n        case 'ascii':\n                // do nothing\n            break;\n        case 'hex':\n            decryptedOutput = DataOperations.dataToHexstring(decryptedOutput);\n            break;\n        default:\n            throw new Error('unsupported output encoding for dukpt decrypt');\n        }\n\n        return decryptedOutput;\n    }\n\n    static _EDE3KeyExpand(key) {\n        return key + key.substring(0, key.length / 2);\n    }\n\n    static _createIPEK(bdk, ksn) {\n        const CBC = 1; // cipher block chaining enabled\n        const iv = '\\0\\0\\0\\0\\0\\0\\0\\0'; // initial vector\n\n        let key = Dukpt._EDE3KeyExpand(bdk); // make 24-byte key\n        key = DataOperations.hexstringToData(key); // make it binary\n\n        let maskedKSN = DataOperations.ANDdata(\n            DataOperations.hexstringToData('FFFFFFFFFFFFFFE00000'),\n            DataOperations.hexstringToData(ksn)\n        ); // this is now binary\n\n        maskedKSN = maskedKSN.substring(0, 8); // take 1st 8 bytes only\n\n        // get LEFT half of IPEK\n        let cipher = Dukpt._des(key,\n            maskedKSN,\n            true, /* encrypt */\n            CBC,\n            iv,\n            null);\n\n        let IPEK = DataOperations.dataToHexstring(cipher);\n\n        // get RIGHT half of IPEK\n        const mask = 'C0C0C0C000000000C0C0C0C000000000';\n        key = DataOperations.XORdata(DataOperations.hexstringToData(mask), DataOperations.hexstringToData(bdk));\n        key = Dukpt._EDE3KeyExpand(key);\n        cipher = Dukpt._des(key,\n            maskedKSN,\n            true, /* encrypt */\n            CBC,\n            iv,\n            null);\n\n        // join the new cipher to the end of the IPEK:\n        IPEK += DataOperations.dataToHexstring(cipher);\n\n        return IPEK;\n    }\n\n    static _getCounter(ksn) {\n        const tailbytes = ksn.substring(ksn.length - 3);\n        const integerValue = (tailbytes.charCodeAt(0) << 16) +\n            (tailbytes.charCodeAt(1) << 8) +\n            tailbytes.charCodeAt(2);\n        return integerValue & 0x1FFFFF;\n    }\n\n    static _deriveKey(ipek, ksnString) {\n        let ksn = ksnString;\n        if (ksn.length === 10) {\n            ksn = ksn.substring(2);\n        } // we want the bottom 8 bytes\n\n        let baseKSN = DataOperations.ANDdata(DataOperations.hexstringToData('FFFFFFFFFFE00000'), ksn);\n        let curKey = ipek;\n        const counter = Dukpt._getCounter(ksn);\n\n        for (let shiftReg = 0x100000; shiftReg > 0; shiftReg >>= 1) {\n            if ((shiftReg & counter) > 0) {\n                // Need to do baseKSN |= shiftReg\n\n                let tmpKSN = baseKSN.substring(0, 5);\n                const byte5 = baseKSN.charCodeAt(5);\n                const byte6 = baseKSN.charCodeAt(6);\n                const byte7 = baseKSN.charCodeAt(7);\n                let tmpLong = (byte5 << 16) + (byte6 << 8) + byte7;\n                tmpLong |= shiftReg;\n                tmpKSN += String.fromCharCode(tmpLong >> 16);\n                tmpKSN += String.fromCharCode(255 & (tmpLong >> 8));\n                tmpKSN += String.fromCharCode(255 & tmpLong);\n\n                baseKSN = tmpKSN; // remember the updated value\n\n                curKey = Dukpt._generateKey(curKey, tmpKSN);\n            }\n        }\n\n        return curKey; // binary\n    }\n\n    static _generateKey(key, ksn) {\n        const mask = 'C0C0C0C000000000C0C0C0C000000000';\n        const maskedKey = DataOperations.XORdata(DataOperations.hexstringToData(mask), key);\n\n        const left = Dukpt._encryptRegister(maskedKey, ksn);\n        const right = Dukpt._encryptRegister(key, ksn);\n\n        return left + right; // binary\n    }\n\n    static _encryptRegister(key, reg) {\n        const CBC = 1; // cipher block chaining enabled\n        const iv = '\\0\\0\\0\\0\\0\\0\\0\\0'; // initial vector\n\n        const bottom8 = key.substring(key.length - 8); // bottom 8 bytes\n\n        const top8 = key.substring(0, 8); // top 8 bytes\n\n        const bottom8xorKSN = DataOperations.XORdata(bottom8, reg);\n\n        // This will be single-DES because of the 8-byte key:\n        const desEncrypted = Dukpt._des(top8,\n            bottom8xorKSN,\n            true, /* encrypt */\n            CBC,\n            iv,\n            null);\n\n        return DataOperations.XORdata(bottom8, desEncrypted);\n    }\n\n    static _deriveKeyHex(ipek, ksn) {\n        const binipek = DataOperations.hexstringToData(ipek);\n        const binksn = DataOperations.hexstringToData(ksn);\n\n        const dk = Dukpt._deriveKey(binipek, binksn);\n        return DataOperations.dataToHexstring(dk);\n    }\n\n    static _des(key, message, encrypt, mode, iv, padding) {\n        let msg = message;\n        // declaring this locally speeds things up a bit\n        const spfunction1 = [\n            0x1010400, 0, 0x10000, 0x1010404, 0x1010004,\n            0x10404, 0x4, 0x10000, 0x400, 0x1010400,\n            0x1010404, 0x400, 0x1000404, 0x1010004, 0x1000000,\n            0x4, 0x404, 0x1000400, 0x1000400, 0x10400,\n            0x10400, 0x1010000, 0x1010000, 0x1000404,\n            0x10004, 0x1000004, 0x1000004, 0x10004,\n            0, 0x404, 0x10404, 0x1000000, 0x10000,\n            0x1010404, 0x4, 0x1010000, 0x1010400,\n            0x1000000, 0x1000000, 0x400, 0x1010004,\n            0x10000, 0x10400, 0x1000004, 0x400, 0x4,\n            0x1000404, 0x10404, 0x1010404, 0x10004,\n            0x1010000, 0x1000404, 0x1000004, 0x404,\n            0x10404, 0x1010400, 0x404, 0x1000400,\n            0x1000400, 0, 0x10004, 0x10400, 0, 0x1010004\n        ];\n        const spfunction2 = [\n            -0x7fef7fe0, -0x7fff8000, 0x8000, 0x108020, 0x100000,\n            0x20, -0x7fefffe0, -0x7fff7fe0, -0x7fffffe0, -0x7fef7fe0,\n            -0x7fef8000, -0x80000000, -0x7fff8000, 0x100000, 0x20,\n            -0x7fefffe0, 0x108000, 0x100020, -0x7fff7fe0, 0,\n            -0x80000000, 0x8000, 0x108020, -0x7ff00000, 0x100020,\n            -0x7fffffe0, 0, 0x108000, 0x8020, -0x7fef8000, -0x7ff00000,\n            0x8020, 0, 0x108020, -0x7fefffe0, 0x100000, -0x7fff7fe0,\n            -0x7ff00000, -0x7fef8000, 0x8000, -0x7ff00000, -0x7fff8000,\n            0x20, -0x7fef7fe0, 0x108020, 0x20, 0x8000, -0x80000000,\n            0x8020, -0x7fef8000, 0x100000, -0x7fffffe0, 0x100020,\n            -0x7fff7fe0, -0x7fffffe0, 0x100020, 0x108000, 0, -0x7fff8000,\n            0x8020, -0x80000000, -0x7fefffe0, -0x7fef7fe0, 0x108000\n        ];\n        const spfunction3 = [\n            0x208, 0x8020200, 0, 0x8020008, 0x8000200, 0,\n            0x20208, 0x8000200, 0x20008, 0x8000008, 0x8000008,\n            0x20000, 0x8020208, 0x20008, 0x8020000, 0x208,\n            0x8000000, 0x8, 0x8020200, 0x200, 0x20200, 0x8020000,\n            0x8020008, 0x20208, 0x8000208, 0x20200, 0x20000, 0x8000208,\n            0x8, 0x8020208, 0x200, 0x8000000, 0x8020200, 0x8000000,\n            0x20008, 0x208, 0x20000, 0x8020200, 0x8000200, 0, 0x200,\n            0x20008, 0x8020208, 0x8000200, 0x8000008, 0x200, 0,\n            0x8020008, 0x8000208, 0x20000, 0x8000000, 0x8020208,\n            0x8, 0x20208, 0x20200, 0x8000008, 0x8020000, 0x8000208,\n            0x208, 0x8020000, 0x20208, 0x8, 0x8020008, 0x20200\n        ];\n        const spfunction4 = [\n            0x802001, 0x2081, 0x2081, 0x80, 0x802080, 0x800081,\n            0x800001, 0x2001, 0, 0x802000, 0x802000, 0x802081, 0x81,\n            0, 0x800080, 0x800001, 0x1, 0x2000, 0x800000, 0x802001,\n            0x80, 0x800000, 0x2001, 0x2080, 0x800081, 0x1, 0x2080,\n            0x800080, 0x2000, 0x802080, 0x802081, 0x81, 0x800080, 0x800001,\n            0x802000, 0x802081, 0x81, 0, 0, 0x802000, 0x2080, 0x800080,\n            0x800081, 0x1, 0x802001, 0x2081, 0x2081, 0x80, 0x802081, 0x81,\n            0x1, 0x2000, 0x800001, 0x2001, 0x802080, 0x800081, 0x2001,\n            0x2080, 0x800000, 0x802001, 0x80, 0x800000, 0x2000, 0x802080\n        ];\n        const spfunction5 = [\n            0x100, 0x2080100, 0x2080000, 0x42000100, 0x80000, 0x100,\n            0x40000000, 0x2080000, 0x40080100, 0x80000, 0x2000100, 0x40080100,\n            0x42000100, 0x42080000, 0x80100, 0x40000000, 0x2000000, 0x40080000,\n            0x40080000, 0, 0x40000100, 0x42080100, 0x42080100, 0x2000100, 0x42080000,\n            0x40000100, 0, 0x42000000, 0x2080100, 0x2000000, 0x42000000, 0x80100,\n            0x80000, 0x42000100, 0x100, 0x2000000, 0x40000000, 0x2080000, 0x42000100,\n            0x40080100, 0x2000100, 0x40000000, 0x42080000, 0x2080100, 0x40080100, 0x100,\n            0x2000000, 0x42080000, 0x42080100, 0x80100, 0x42000000, 0x42080100, 0x2080000, 0,\n            0x40080000, 0x42000000, 0x80100, 0x2000100, 0x40000100, 0x80000, 0, 0x40080000,\n            0x2080100, 0x40000100\n        ];\n        const spfunction6 = [\n            0x20000010, 0x20400000, 0x4000, 0x20404010, 0x20400000, 0x10, 0x20404010,\n            0x400000, 0x20004000, 0x404010, 0x400000, 0x20000010, 0x400010, 0x20004000,\n            0x20000000, 0x4010, 0, 0x400010, 0x20004010, 0x4000, 0x404000, 0x20004010,\n            0x10, 0x20400010, 0x20400010, 0, 0x404010, 0x20404000, 0x4010, 0x404000,\n            0x20404000, 0x20000000, 0x20004000, 0x10, 0x20400010, 0x404000, 0x20404010,\n            0x400000, 0x4010, 0x20000010, 0x400000, 0x20004000, 0x20000000, 0x4010,\n            0x20000010, 0x20404010, 0x404000, 0x20400000, 0x404010, 0x20404000, 0,\n            0x20400010, 0x10, 0x4000, 0x20400000, 0x404010, 0x4000, 0x400010, 0x20004010,\n            0, 0x20404000, 0x20000000, 0x400010, 0x20004010\n        ];\n        const spfunction7 = [\n            0x200000, 0x4200002, 0x4000802, 0, 0x800, 0x4000802, 0x200802, 0x4200800,\n            0x4200802, 0x200000, 0, 0x4000002, 0x2, 0x4000000, 0x4200002, 0x802, 0x4000800,\n            0x200802, 0x200002, 0x4000800, 0x4000002, 0x4200000, 0x4200800, 0x200002,\n            0x4200000, 0x800, 0x802, 0x4200802, 0x200800, 0x2, 0x4000000, 0x200800,\n            0x4000000, 0x200800, 0x200000, 0x4000802, 0x4000802, 0x4200002, 0x4200002,\n            0x2, 0x200002, 0x4000000, 0x4000800, 0x200000, 0x4200800, 0x802, 0x200802,\n            0x4200800, 0x802, 0x4000002, 0x4200802, 0x4200000, 0x200800, 0, 0x2, 0x4200802,\n            0, 0x200802, 0x4200000, 0x800, 0x4000002, 0x4000800, 0x800, 0x200002\n        ];\n        const spfunction8 = [\n            0x10001040, 0x1000, 0x40000, 0x10041040, 0x10000000, 0x10001040, 0x40, 0x10000000,\n            0x40040, 0x10040000, 0x10041040, 0x41000, 0x10041000, 0x41040, 0x1000,\n            0x40, 0x10040000, 0x10000040, 0x10001000, 0x1040, 0x41000, 0x40040,\n            0x10040040, 0x10041000, 0x1040, 0, 0, 0x10040040, 0x10000040, 0x10001000,\n            0x41040, 0x40000, 0x41040, 0x40000, 0x10041000, 0x1000, 0x40, 0x10040040,\n            0x1000, 0x41040, 0x10001000, 0x40, 0x10000040, 0x10040000, 0x10040040,\n            0x10000000, 0x40000, 0x10001040, 0, 0x10041040, 0x40040, 0x10000040,\n            0x10040000, 0x10001000, 0x10001040, 0, 0x10041040, 0x41000, 0x41000, 0x1040,\n            0x1040, 0x40040, 0x10000000, 0x10041000\n        ];\n\n        // create the subkeys we will need\n        const keys = Dukpt._desCreateKeys(key);\n        let m = 0;\n        let i;\n        let j;\n        let temp;\n        let right1;\n        let right2;\n        let left;\n        let right;\n        let looping;\n        let cbcleft;\n        let cbcleft2;\n        let cbcright;\n        let cbcright2;\n        let endloop;\n        let loopinc;\n        let len = msg.length;\n        let chunk = 0;\n        // set up the loops for single and triple _des\n        const iterations = keys.length === 32 ? 3 : 9; // single or triple _des\n        if (iterations === 3) {\n            looping = encrypt ? [0, 32, 2] : [30, -2, -2];\n        } else {\n            looping = encrypt ? [0, 32, 2, 62, 30, -2, 64, 96, 2] : [94, 62, -2, 32, 64, 2, 30, -2, -2];\n        }\n\n        // pad the msg depending on the padding parameter\n        if (padding === 2) msg += '        '; // pad the msg with spaces\n        else if (padding === 1) {\n            temp = 8 - (len % 8);\n            msg += String.fromCharCode(temp, temp, temp, temp, temp, temp, temp, temp);\n            if (temp === 8) len += 8;\n        } else if (!padding) msg += '\\0\\0\\0\\0\\0\\0\\0\\0'; // pad the msg out with null bytes\n\n        // store the result here\n        let result = '';\n        let tempresult = '';\n\n        if (mode === 1) { // CBC mode\n            cbcleft = (iv.charCodeAt(m++) << 24) | (iv.charCodeAt(m++) << 16) | (iv.charCodeAt(m++) << 8) | iv.charCodeAt(m++);\n            cbcright = (iv.charCodeAt(m++) << 24) | (iv.charCodeAt(m++) << 16) | (iv.charCodeAt(m++) << 8) | iv.charCodeAt(m++);\n            m = 0;\n        }\n\n        // loop through each 64 bit chunk of the msg\n        while (m < len) {\n            left = (msg.charCodeAt(m++) << 24) | (msg.charCodeAt(m++) << 16) | (msg.charCodeAt(m++) << 8) | msg.charCodeAt(m++);\n            right = (msg.charCodeAt(m++) << 24) | (msg.charCodeAt(m++) << 16) | (msg.charCodeAt(m++) << 8) | msg.charCodeAt(m++);\n\n            // for Cipher Block Chaining mode, xor the msg with the previous result\n            if (mode === 1) {\n                if (encrypt) {\n                    left ^= cbcleft;\n                    right ^= cbcright;\n                } else {\n                    cbcleft2 = cbcleft;\n                    cbcright2 = cbcright;\n                    cbcleft = left;\n                    cbcright = right;\n                }\n            }\n\n            // first each 64 but chunk of the msg must be permuted according to IP\n            temp = ((left >>> 4) ^ right) & 0x0f0f0f0f;\n            right ^= temp;\n            left ^= (temp << 4);\n            temp = ((left >>> 16) ^ right) & 0x0000ffff;\n            right ^= temp;\n            left ^= (temp << 16);\n            temp = ((right >>> 2) ^ left) & 0x33333333;\n            left ^= temp;\n            right ^= (temp << 2);\n            temp = ((right >>> 8) ^ left) & 0x00ff00ff;\n            left ^= temp;\n            right ^= (temp << 8);\n            temp = ((left >>> 1) ^ right) & 0x55555555;\n            right ^= temp;\n            left ^= (temp << 1);\n\n            left = ((left << 1) | (left >>> 31));\n            right = ((right << 1) | (right >>> 31));\n\n            // do this either 1 or 3 times for each chunk of the msg\n            for (j = 0; j < iterations; j += 3) {\n                endloop = looping[j + 1];\n                loopinc = looping[j + 2];\n                // now go through and perform the encryption or decryption\n                for (i = looping[j]; i !== endloop; i += loopinc) { // for efficiency\n                    right1 = right ^ keys[i];\n                    right2 = ((right >>> 4) | (right << 28)) ^ keys[i + 1];\n                    // the result is attained by passing these bytes through the S selection functions\n                    temp = left;\n                    left = right;\n                    right = temp ^ (spfunction2[(right1 >>> 24) & 0x3f] | spfunction4[(right1 >>> 16) & 0x3f]\n                        | spfunction6[(right1 >>> 8) & 0x3f] | spfunction8[right1 & 0x3f]\n                        | spfunction1[(right2 >>> 24) & 0x3f] | spfunction3[(right2 >>> 16) & 0x3f]\n                        | spfunction5[(right2 >>> 8) & 0x3f] | spfunction7[right2 & 0x3f]);\n                }\n                temp = left;\n                left = right;\n                right = temp; // unreverse left and right\n            } // for either 1 or 3 iterations\n\n            // move then each one bit to the right\n            left = ((left >>> 1) | (left << 31));\n            right = ((right >>> 1) | (right << 31));\n\n            // now perform IP-1, which is IP in the opposite direction\n            temp = ((left >>> 1) ^ right) & 0x55555555;\n            right ^= temp;\n            left ^= (temp << 1);\n            temp = ((right >>> 8) ^ left) & 0x00ff00ff;\n            left ^= temp;\n            right ^= (temp << 8);\n            temp = ((right >>> 2) ^ left) & 0x33333333;\n            left ^= temp;\n            right ^= (temp << 2);\n            temp = ((left >>> 16) ^ right) & 0x0000ffff;\n            right ^= temp;\n            left ^= (temp << 16);\n            temp = ((left >>> 4) ^ right) & 0x0f0f0f0f;\n            right ^= temp;\n            left ^= (temp << 4);\n\n            // for Cipher Block Chaining mode, xor the msg with the previous result\n            if (mode === 1) {\n                if (encrypt) {\n                    cbcleft = left;\n                    cbcright = right;\n                } else {\n                    left ^= cbcleft2;\n                    right ^= cbcright2;\n                }\n            }\n            tempresult += String.fromCharCode(\n                (left >>> 24),\n                ((left >>> 16) & 0xff),\n                ((left >>> 8) & 0xff),\n                (left & 0xff),\n                (right >>> 24),\n                ((right >>> 16) & 0xff),\n                ((right >>> 8) & 0xff),\n                (right & 0xff)\n            );\n\n            chunk += 8;\n            if (chunk === 512) {\n                result += tempresult;\n                tempresult = '';\n                chunk = 0;\n            }\n        } // for every 8 characters, or 64 bits in the msg\n\n        result += tempresult;\n        /* result = result.replace(/\\0*$/g, \"\"); */\n\n        return result;\n    }\n\n    static _desCreateKeys(key) {\n        const pc2bytes0 = [0, 0x4, 0x20000000, 0x20000004, 0x10000, 0x10004, 0x20010000, 0x20010004, 0x200, 0x204, 0x20000200, 0x20000204, 0x10200, 0x10204, 0x20010200, 0x20010204];\n        const pc2bytes1 = [0, 0x1, 0x100000, 0x100001, 0x4000000, 0x4000001, 0x4100000, 0x4100001, 0x100, 0x101, 0x100100, 0x100101, 0x4000100, 0x4000101, 0x4100100, 0x4100101];\n        const pc2bytes2 = [0, 0x8, 0x800, 0x808, 0x1000000, 0x1000008, 0x1000800, 0x1000808, 0, 0x8, 0x800, 0x808, 0x1000000, 0x1000008, 0x1000800, 0x1000808];\n        const pc2bytes3 = [0, 0x200000, 0x8000000, 0x8200000, 0x2000, 0x202000, 0x8002000, 0x8202000, 0x20000, 0x220000, 0x8020000, 0x8220000, 0x22000, 0x222000, 0x8022000, 0x8222000];\n        const pc2bytes4 = [0, 0x40000, 0x10, 0x40010, 0, 0x40000, 0x10, 0x40010, 0x1000, 0x41000, 0x1010, 0x41010, 0x1000, 0x41000, 0x1010, 0x41010];\n        const pc2bytes5 = [0, 0x400, 0x20, 0x420, 0, 0x400, 0x20, 0x420, 0x2000000, 0x2000400, 0x2000020, 0x2000420, 0x2000000, 0x2000400, 0x2000020, 0x2000420];\n        const pc2bytes6 = [0, 0x10000000, 0x80000, 0x10080000, 0x2, 0x10000002, 0x80002, 0x10080002, 0, 0x10000000, 0x80000, 0x10080000, 0x2, 0x10000002, 0x80002, 0x10080002];\n        const pc2bytes7 = [0, 0x10000, 0x800, 0x10800, 0x20000000, 0x20010000, 0x20000800, 0x20010800, 0x20000, 0x30000, 0x20800, 0x30800, 0x20020000, 0x20030000, 0x20020800, 0x20030800];\n        const pc2bytes8 = [0, 0x40000, 0, 0x40000, 0x2, 0x40002, 0x2, 0x40002, 0x2000000, 0x2040000, 0x2000000, 0x2040000, 0x2000002, 0x2040002, 0x2000002, 0x2040002];\n        const pc2bytes9 = [0, 0x10000000, 0x8, 0x10000008, 0, 0x10000000, 0x8, 0x10000008, 0x400, 0x10000400, 0x408, 0x10000408, 0x400, 0x10000400, 0x408, 0x10000408];\n        const pc2bytes10 = [0, 0x20, 0, 0x20, 0x100000, 0x100020, 0x100000, 0x100020, 0x2000, 0x2020, 0x2000, 0x2020, 0x102000, 0x102020, 0x102000, 0x102020];\n        const pc2bytes11 = [0, 0x1000000, 0x200, 0x1000200, 0x200000, 0x1200000, 0x200200, 0x1200200, 0x4000000, 0x5000000, 0x4000200, 0x5000200, 0x4200000, 0x5200000, 0x4200200, 0x5200200];\n        const pc2bytes12 = [0, 0x1000, 0x8000000, 0x8001000, 0x80000, 0x81000, 0x8080000, 0x8081000, 0x10, 0x1010, 0x8000010, 0x8001010, 0x80010, 0x81010, 0x8080010, 0x8081010];\n        const pc2bytes13 = [0, 0x4, 0x100, 0x104, 0, 0x4, 0x100, 0x104, 0x1, 0x5, 0x101, 0x105, 0x1, 0x5, 0x101, 0x105];\n\n        // how many iterations (1 for _des, 3 for triple _des)\n        const iterations = key.length > 8 ? 3 : 1; // use Triple DES for 9+ byte keys\n        // stores the return keys\n        const keys = new Array(32 * iterations);\n        // now define the left shifts which need to be done\n        const shifts = [0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0];\n        // other variables\n        let lefttemp;\n        let righttemp;\n        let m = 0;\n        let n = 0;\n        let temp;\n\n        for (let j = 0; j < iterations; j++) { // either 1 or 3 iterations\n            let left = (key.charCodeAt(m++) << 24) | (key.charCodeAt(m++) << 16) | (key.charCodeAt(m++) << 8) | key.charCodeAt(m++);\n            let right = (key.charCodeAt(m++) << 24) | (key.charCodeAt(m++) << 16) | (key.charCodeAt(m++) << 8) | key.charCodeAt(m++);\n\n            temp = ((left >>> 4) ^ right) & 0x0f0f0f0f;\n            right ^= temp;\n            left ^= (temp << 4);\n            temp = ((right >>> -16) ^ left) & 0x0000ffff;\n            left ^= temp;\n            right ^= (temp << -16);\n            temp = ((left >>> 2) ^ right) & 0x33333333;\n            right ^= temp;\n            left ^= (temp << 2);\n            temp = ((right >>> -16) ^ left) & 0x0000ffff;\n            left ^= temp;\n            right ^= (temp << -16);\n            temp = ((left >>> 1) ^ right) & 0x55555555;\n            right ^= temp;\n            left ^= (temp << 1);\n            temp = ((right >>> 8) ^ left) & 0x00ff00ff;\n            left ^= temp;\n            right ^= (temp << 8);\n            temp = ((left >>> 1) ^ right) & 0x55555555;\n            right ^= temp;\n            left ^= (temp << 1);\n\n            // the right side needs to be shifted and to get the last four bits of the left side\n            temp = (left << 8) | ((right >>> 20) & 0x000000f0);\n            // left needs to be put upside down\n            left = (right << 24) | ((right << 8) & 0xff0000) | ((right >>> 8) & 0xff00) | ((right >>> 24) & 0xf0);\n            right = temp;\n\n            // now go through and perform these shifts on the left and right keys\n            for (let i = 0; i < shifts.length; i++) {\n                // shift the keys either one or two bits to the left\n                if (shifts[i]) {\n                    left = (left << 2) | (left >>> 26);\n                    right = (right << 2) | (right >>> 26);\n                } else {\n                    left = (left << 1) | (left >>> 27);\n                    right = (right << 1) | (right >>> 27);\n                }\n                left &= -0xf;\n                right &= -0xf;\n\n                // Now apply PC-2, in such a way that E is easier when encrypting or decrypting.\n                // This conversion will look like PC-2 except only the last 6 bits of each byte are used\n                // rather than 48 consecutive bits and the order of lines will be according to\n                // how the S selection functions will be applied: S2, S4, S6, S8, S1, S3, S5, S7\n                lefttemp = pc2bytes0[left >>> 28] | pc2bytes1[(left >>> 24) & 0xf]\n                    | pc2bytes2[(left >>> 20) & 0xf] | pc2bytes3[(left >>> 16) & 0xf]\n                    | pc2bytes4[(left >>> 12) & 0xf] | pc2bytes5[(left >>> 8) & 0xf]\n                    | pc2bytes6[(left >>> 4) & 0xf];\n                righttemp = pc2bytes7[right >>> 28] | pc2bytes8[(right >>> 24) & 0xf]\n                    | pc2bytes9[(right >>> 20) & 0xf] | pc2bytes10[(right >>> 16) & 0xf]\n                    | pc2bytes11[(right >>> 12) & 0xf] | pc2bytes12[(right >>> 8) & 0xf]\n                    | pc2bytes13[(right >>> 4) & 0xf];\n                temp = ((righttemp >>> 16) ^ lefttemp) & 0x0000ffff;\n                keys[n++] = lefttemp ^ temp;\n                keys[n++] = righttemp ^ (temp << 16);\n            }\n        } // for each iterations\n        // return the keys we've created\n        return keys;\n    }\n\n    static encryptAES(key, data) {\n        // convert to integer arrays for AES\n        const keyArray = DataOperations.hexstringToNumericArray(key);\n        const dataArray = DataOperations.hexstringToNumericArray(data);\n\n        if (keyArray.length !== 16) {\n            throw new Error('Key must be 16 bytes for AES.');\n        }\n\n        while (dataArray.length % 16) { dataArray.push(0); }  // pad with zeroes\n\n        // The initialization vector, which can be null\n        const iv = null;\n\n        // We will use CBC mode:\n        const CBC = aesjs.ModeOfOperation.cbc;\n        const aesCbc = new CBC(keyArray, iv);\n\n        function accumulate(a, b) {\n            for (let i = 0; i < b.length; i++) {\n                a.push(b[i]);\n            }\n        }\n\n        const bytes = [];\n\n        for (let i = 0; i < dataArray.length; i += 16) {\n            const result = aesCbc.encrypt(Buffer.from(dataArray.slice(i, i + 16)));\n            accumulate(bytes, result);\n        }\n\n        return DataOperations.hexstringToData(DataOperations.numericArrayToHexstring(bytes));\n    }\n\n    static decryptAES(key, data) {\n        // convert to integer arrays for AES\n        const keyArray = DataOperations.hexstringToNumericArray(key);\n        const dataArray = DataOperations.hexstringToNumericArray(data);\n\n        if (keyArray.length !== 16) {\n            throw new Error('Key must be 16 bytes for AES.');\n        }\n\n        while (dataArray.length % 16) {\n            dataArray.push(0);\n        }  // pad with zeroes\n\n        // The initialization vector, which can be null\n        const iv = null;\n\n        // We will use CBC mode:\n        const CBC = aesjs.ModeOfOperation.cbc;\n        const aesCbc = new CBC(keyArray, iv);\n\n        function accumulate(a, b) {\n            for (let i = 0; i < b.length; i++) {\n                a.push(b[i]);\n            }\n        }\n\n        const bytes = [];\n\n        for (let i = 0; i < dataArray.length; i += 16) {\n            const result = aesCbc.decrypt(Buffer.from(dataArray.slice(i, i + 16)));\n            accumulate(bytes, result);\n        }\n\n        return DataOperations.hexstringToData(DataOperations.numericArrayToHexstring(bytes));\n    }\n}\n\nmodule.exports = Dukpt;\n"]}